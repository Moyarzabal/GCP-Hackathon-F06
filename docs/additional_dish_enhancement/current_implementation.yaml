name: "ã‚‚ã†ä¸€å“æ©Ÿèƒ½å¼·åŒ– - ç¾åœ¨ã®å®Ÿè£…çŠ¶æ³"
version: "1.0"
date: "2025-01-19"
author: "Claude AI Assistant"

# ç¾åœ¨ã®ã€Œã‚‚ã†ä¸€å“ã€æ©Ÿèƒ½å®Ÿè£…çŠ¶æ³ã®åˆ†æ

## ç¾åœ¨ã®å®Ÿè£…ãƒ¬ãƒ™ãƒ«

### UIå®Ÿè£… âœ…
location: "lib/features/meal_planning/presentation/pages/meal_plan_screen.dart"
implementation_status: "å®Œå…¨å®Ÿè£…æ¸ˆã¿"
features:
  - square_card_button: "2x2ã‚°ãƒªãƒƒãƒ‰ã®å³ä¸‹ã«é…ç½®æ¸ˆã¿"
  - dialog_ui: "ã‚¸ãƒ£ãƒ³ãƒ«é¸æŠãƒ€ã‚¤ã‚¢ãƒ­ã‚°å®Ÿè£…æ¸ˆã¿"
  - dish_options: "å‰¯èœãƒ»æ±ç‰©ãƒ»ãŠã¤ã¾ã¿ã®é¸æŠè‚¢"
  - loading_dialog: "ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¡¨ç¤ºå®Ÿè£…æ¸ˆã¿"

ui_components:
  main_button:
    location: "Line 327-330"
    code: |
      MealPlanSquareCard(
        title: 'ã‚‚ã†ä¸€å“',
        isAddButton: true,
        onTap: () => _suggestAdditionalDish(mealPlan),
      )
  
  selection_dialog:
    location: "Line 1355-1414"
    features:
      - title: "ã‚‚ã†ä¸€å“è¿½åŠ "
      - options: ["å‰¯èœ", "æ±ç‰©", "ãŠã¤ã¾ã¿"]
      - ui_style: "çµ±ä¸€ã•ã‚ŒãŸã‚¯ãƒªãƒ¼ãƒ è‰²åŸºèª¿"
  
  dish_option_widget:
    location: "Line 1416-1470"
    features:
      - icon_display: "å„ã‚¸ãƒ£ãƒ³ãƒ«ã®ã‚¢ã‚¤ã‚³ãƒ³"
      - description: "ã‚¸ãƒ£ãƒ³ãƒ«èª¬æ˜æ–‡"
      - tap_interaction: "ã‚¿ãƒƒãƒ—æ™‚ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³"

### ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ âŒ
implementation_status: "ã‚¹ã‚¿ãƒ–å®Ÿè£…ã®ã¿"
current_behavior:
  - loading_simulation: "2ç§’ã®Future.delayed"
  - placeholder_message: "ã€Œâ—‹â—‹ã®ææ¡ˆæ©Ÿèƒ½ã¯æº–å‚™ä¸­ã§ã™ã€"
  - no_actual_generation: "å®Ÿéš›ã®æ–™ç†ç”Ÿæˆãªã—"

stub_implementation:
  location: "Line 1472-1516"
  code: |
    Future<void> _addAdditionalDish(String dishType) async {
      // ä»®ã®å‡¦ç†ï¼ˆå°†æ¥çš„ã«AIå‘¼ã³å‡ºã—ã«ç½®ãæ›ãˆï¼‰
      await Future.delayed(Duration(seconds: 2));
      ScaffoldMessenger.of(context).showSnackBar(
        SnackBar(
          content: Text('${dishType}ã®ææ¡ˆæ©Ÿèƒ½ã¯æº–å‚™ä¸­ã§ã™'),
        ),
      );
    }

### ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ« âŒ
additional_dish_fields: "MealPlanãƒ¢ãƒ‡ãƒ«ã«æœªå®Ÿè£…"
current_meal_plan_structure:
  - mainDish: "MealItem âœ…"
  - sideDish: "MealItem âœ…"
  - soup: "MealItem âœ…"
  - rice: "MealItem âœ…"
  - additionalDishes: "æœªå®Ÿè£… âŒ"

missing_fields:
  - additionalMainDish: "è¿½åŠ ä¸»èœ"
  - additionalSideDish: "è¿½åŠ å‰¯èœ"
  - additionalSoup: "è¿½åŠ æ±ç‰©"
  - additionalSnack: "ãŠã¤ã¾ã¿"

### AI ã‚µãƒ¼ãƒ“ã‚¹é€£æº âŒ
current_ai_service: "lib/core/services/ai_meal_planning_service.dart"
existing_methods:
  - suggestMealPlan: "åŸºæœ¬4å“æ§‹æˆã®çŒ®ç«‹ç”Ÿæˆ âœ…"
  - suggestAlternatives: "ä»£æ›¿çŒ®ç«‹ç”Ÿæˆ âœ…"
  - generateShoppingList: "è²·ã„ç‰©ãƒªã‚¹ãƒˆç”Ÿæˆ âœ…"

missing_methods:
  - generateAdditionalDishes: "è¿½åŠ æ–™ç†ç”Ÿæˆæ©Ÿèƒ½ âŒ"
  - getAdditionalDishByType: "ã‚¸ãƒ£ãƒ³ãƒ«åˆ¥è¿½åŠ æ–™ç†å–å¾— âŒ"

## å•é¡Œç‚¹ã¨æ”¹å–„ãŒå¿…è¦ãªç®‡æ‰€

### 1. äº‹å‰ç”Ÿæˆæ©Ÿèƒ½ã®ä¸åœ¨
current_problem: "ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒé¸æŠã—ã¦ã‹ã‚‰æ–™ç†ã‚’ç”Ÿæˆã™ã‚‹è¨­è¨ˆ"
desired_behavior: "çŒ®ç«‹ææ¡ˆæ™‚ã«å…¨ã‚¸ãƒ£ãƒ³ãƒ«ã®è¿½åŠ æ–™ç†ã‚’äº‹å‰ç”Ÿæˆ"
impact: "å¿œç­”æ™‚é–“ã®é…å»¶ã¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½“é¨“ã®æ‚ªåŒ–"

### 2. ãƒ‡ãƒ¼ã‚¿ä¿å­˜æ©Ÿèƒ½ã®ä¸åœ¨
current_problem: "ç”Ÿæˆã•ã‚ŒãŸè¿½åŠ æ–™ç†ã®ä¿å­˜æ©Ÿèƒ½ãªã—"
desired_behavior: "MealPlanã¨ä¸€ç·’ã«è¿½åŠ æ–™ç†ã‚‚ä¿å­˜"
impact: "å†è¡¨ç¤ºæ™‚ã®ä¸€è²«æ€§ãŒãªã„"

### 3. ADKé€£æºã®ä¸å‚™
current_problem: "ADK APIã¨ã®é€£æºãŒæœªå®Ÿè£…"
desired_behavior: "ADKã§å…¨ã‚¸ãƒ£ãƒ³ãƒ«ã®è¿½åŠ æ–™ç†ã‚’åŒæ™‚ç”Ÿæˆ"
impact: "å®Ÿéš›ã®æ–™ç†ææ¡ˆãŒã§ããªã„"

### 4. UIè¡¨ç¤ºæ©Ÿèƒ½ã®ä¸å®Œå…¨æ€§
current_problem: "ç”Ÿæˆã•ã‚ŒãŸæ–™ç†ã®è©³ç´°è¡¨ç¤ºæ©Ÿèƒ½ãªã—"
desired_behavior: "é¸æŠã•ã‚ŒãŸã‚¸ãƒ£ãƒ³ãƒ«ã®æ–™ç†è©³ç´°ã‚’è¡¨ç¤º"
impact: "ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒæ–™ç†å†…å®¹ã‚’ç¢ºèªã§ããªã„"

## æŠ€è¡“çš„åˆ¶ç´„ã¨è€ƒæ…®äº‹é …

### ADK APIåˆ¶ç´„
current_api_structure:
  - single_meal_generation: "1å›ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã§1ã¤ã®çŒ®ç«‹ç”Ÿæˆ"
  - no_batch_generation: "è¤‡æ•°æ–™ç†ã®ä¸€æ‹¬ç”Ÿæˆæ©Ÿèƒ½ãªã—"

required_enhancement:
  - extended_prompt: "è¿½åŠ æ–™ç†ã‚‚å«ã‚ãŸæ‹¡å¼µãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ"
  - response_parsing: "è¤‡æ•°æ–™ç†ã‚’å«ã‚€ãƒ¬ã‚¹ãƒãƒ³ã‚¹è§£æ"

### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆ
current_firestore_structure:
  collection: "meal_plans"
  document_structure: "åŸºæœ¬4å“ã®ã¿"

required_extension:
  additional_fields:
    - additionalDishes: "Map<String, MealItem>"
    - additionalDishesGenerated: "bool"
    - additionalDishesGeneratedAt: "DateTime"

### ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è€ƒæ…®
generation_timing: "çŒ®ç«‹ç”Ÿæˆæ™‚ã«è¿½åŠ æ–™ç†ã‚‚åŒæ™‚ç”Ÿæˆ"
response_time_impact: "ç”Ÿæˆæ™‚é–“ã®å¢—åŠ ï¼ˆæ¨å®š1.5-2å€ï¼‰"
caching_strategy: "ç”Ÿæˆæ¸ˆã¿è¿½åŠ æ–™ç†ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥"

## æ—¢å­˜æ©Ÿèƒ½ã¨ã®æ•´åˆæ€§

### UIçµ±ä¸€æ€§ âœ…
color_scheme: "æ—¢å­˜ã®ã‚¯ãƒªãƒ¼ãƒ è‰²åŸºèª¿ã¨çµ±ä¸€æ¸ˆã¿"
component_style: "MealPlanSquareCardã¨ã®ä¸€è²«æ€§"
interaction_pattern: "æ—¢å­˜ã®ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ãƒ‘ã‚¿ãƒ¼ãƒ³ã¨çµ±ä¸€"

### çŠ¶æ…‹ç®¡ç† ğŸ”„
current_provider: "MealPlanNotifier"
required_extension: "è¿½åŠ æ–™ç†ã®çŠ¶æ…‹ç®¡ç†æ©Ÿèƒ½"
integration_point: "æ—¢å­˜ã®mealPlanProviderã®æ‹¡å¼µ"

### ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚° ğŸ”„
current_handling: "åŸºæœ¬çš„ãªtry-catchå®Ÿè£…"
required_enhancement: "è¿½åŠ æ–™ç†ç”Ÿæˆå¤±æ•—æ™‚ã®é©åˆ‡ãªå‡¦ç†"

## å®Ÿè£…å„ªå…ˆåº¦

### é«˜å„ªå…ˆåº¦
1. MealPlanãƒ¢ãƒ‡ãƒ«ã®æ‹¡å¼µï¼ˆè¿½åŠ æ–™ç†ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ï¼‰
2. AIçŒ®ç«‹ã‚µãƒ¼ãƒ“ã‚¹ã®æ‹¡å¼µï¼ˆäº‹å‰ç”Ÿæˆæ©Ÿèƒ½ï¼‰
3. è¿½åŠ æ–™ç†è¡¨ç¤ºUI ã®å®Ÿè£…

### ä¸­å„ªå…ˆåº¦
4. Firestoreã‚¹ã‚­ãƒ¼ãƒã®æ‹¡å¼µ
5. ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®å¼·åŒ–
6. ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–

### ä½å„ªå…ˆåº¦
7. è¿½åŠ æ–™ç†ã®ç”»åƒç”Ÿæˆé€£æº
8. è¿½åŠ æ–™ç†ã®æ „é¤Šæƒ…å ±è¨ˆç®—
9. çµ±è¨ˆãƒ»åˆ†ææ©Ÿèƒ½ã¸ã®åæ˜ 

## å®Ÿè£…å¯èƒ½æ€§è©•ä¾¡

### æŠ€è¡“çš„å®Ÿç¾å¯èƒ½æ€§: â­â­â­â­â˜† (é«˜)
- æ—¢å­˜ã®AIã‚µãƒ¼ãƒ“ã‚¹åŸºç›¤ã‚’æ´»ç”¨å¯èƒ½
- ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«ã®æ‹¡å¼µã¯æ¯”è¼ƒçš„ç°¡å˜
- UIå®Ÿè£…ã¯ã»ã¼å®Œæˆæ¸ˆã¿

### å®Ÿè£…å·¥æ•°: â­â­â­â˜†â˜† (ä¸­)
- æ¨å®šå®Ÿè£…æœŸé–“: 2-3æ—¥
- ä¸»è¦ãªä½œæ¥­: AIã‚µãƒ¼ãƒ“ã‚¹æ‹¡å¼µã€ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«ä¿®æ­£
- ãƒ†ã‚¹ãƒˆå·¥æ•°: 1æ—¥

### é‹ç”¨å½±éŸ¿åº¦: â­â­â˜†â˜†â˜† (ä½)
- æ—¢å­˜æ©Ÿèƒ½ã¸ã®å½±éŸ¿æœ€å°é™
- æ®µéšçš„ãƒªãƒªãƒ¼ã‚¹å¯èƒ½
- ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯å®¹æ˜“

## æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

1. **ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«è¨­è¨ˆ**: è¿½åŠ æ–™ç†ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®è©³ç´°è¨­è¨ˆ
2. **AIãƒ—ãƒ­ãƒ³ãƒ—ãƒˆè¨­è¨ˆ**: å…¨ã‚¸ãƒ£ãƒ³ãƒ«åŒæ™‚ç”Ÿæˆã®ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆä½œæˆ
3. **UIè©³ç´°è¨­è¨ˆ**: è¿½åŠ æ–™ç†è¡¨ç¤ºç”»é¢ã®è¨­è¨ˆ
4. **å®Ÿè£…è¨ˆç”»ç­–å®š**: æ®µéšçš„å®Ÿè£…ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ä½œæˆ
