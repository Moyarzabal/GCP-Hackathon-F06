name: "çŒ®ç«‹å±¥æ­´æ©Ÿèƒ½ - ç¾åœ¨ã®å®Ÿè£…çŠ¶æ³"
version: "1.0"
date: "2025-01-19"
author: "Claude AI Assistant"

# ç¾åœ¨ã®å®Ÿè£…çŠ¶æ³ã®åˆ†æçµæœ

## æ—¢å­˜ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«
meal_plan_model:
  location: "lib/shared/models/meal_plan.dart"
  features:
    - MealPlan: çŒ®ç«‹ã®ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«
    - MealPlanStatus: çŒ®ç«‹ã®çŠ¶æ…‹ç®¡ç†ï¼ˆsuggested, accepted, cooking, completed, cancelledï¼‰
    - MealItem: å€‹åˆ¥ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚¢ã‚¤ãƒ†ãƒ 
    - Ingredient: ææ–™æƒ…å ±
    - Recipe: ãƒ¬ã‚·ãƒ”æƒ…å ±
    - NutritionInfo: æ „é¤Šæƒ…å ±
  fields:
    - id: String?
    - householdId: String
    - date: DateTime
    - status: MealPlanStatus
    - mainDish: MealItem
    - sideDish: MealItem
    - soup: MealItem
    - rice: MealItem
    - totalCookingTime: int
    - difficulty: DifficultyLevel
    - nutritionScore: double
    - confidence: double
    - alternatives: List<MealPlan>
    - createdAt: DateTime
    - createdBy: String
    - acceptedAt: DateTime?
    - completedAt: DateTime?
    - shoppingList: List<ShoppingItem>?
    - popularityScore: int?
    - cookingFrequency: String?
    - seasonalRelevance: String?
    - refrigeratorUsage: Map<String, dynamic>?

### ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼å®Ÿè£…
meal_plan_provider:
  location: "lib/features/meal_planning/presentation/providers/meal_plan_provider.dart"
  existing_providers:
    - mealPlanProvider: ç¾åœ¨ã®çŒ®ç«‹ç®¡ç†
    - mealPlanHistoryProvider: çŒ®ç«‹å±¥æ­´ç®¡ç†ï¼ˆæ—¢ã«å®Ÿè£…æ¸ˆã¿ï¼‰
    - shoppingListProvider: è²·ã„ç‰©ãƒªã‚¹ãƒˆç®¡ç†
  existing_notifiers:
    - MealPlanNotifier: çŒ®ç«‹ã®çŠ¶æ…‹ç®¡ç†
    - MealPlanHistoryNotifier: çŒ®ç«‹å±¥æ­´ã®çŠ¶æ…‹ç®¡ç†ï¼ˆæ—¢ã«å®Ÿè£…æ¸ˆã¿ï¼‰
    - ShoppingListNotifier: è²·ã„ç‰©ãƒªã‚¹ãƒˆã®çŠ¶æ…‹ç®¡ç†

### Firestoreã‚µãƒ¼ãƒ“ã‚¹
firestore_service:
  location: "lib/core/services/firestore_service.dart"
  existing_methods:
    - saveMealPlan(MealPlan): çŒ®ç«‹ä¿å­˜
    - getMealPlanHistory(String, DateTime?, DateTime?, int): çŒ®ç«‹å±¥æ­´å–å¾—ï¼ˆæ—¢ã«å®Ÿè£…æ¸ˆã¿ï¼‰
    - getMealPlan(String): å€‹åˆ¥çŒ®ç«‹å–å¾—
    - updateMealPlanStatus(String, MealPlanStatus): çŒ®ç«‹çŠ¶æ…‹æ›´æ–°
    - updateMealPlanRating(String, double): çŒ®ç«‹è©•ä¾¡æ›´æ–°
  firestore_collections:
    - meal_plans: çŒ®ç«‹ãƒ‡ãƒ¼ã‚¿ä¿å­˜

### UIå®Ÿè£…
meal_plan_screen:
  location: "lib/features/meal_planning/presentation/pages/meal_plan_screen.dart"
  existing_features:
    - çŒ®ç«‹ææ¡ˆè¡¨ç¤º
    - çŒ®ç«‹æ±ºå®šæ©Ÿèƒ½
    - å†ææ¡ˆæ©Ÿèƒ½
    - ã‚‚ã†ä¸€å“è¿½åŠ æ©Ÿèƒ½
    - è²·ã„ç‰©ãƒªã‚¹ãƒˆè¡¨ç¤º
  history_button:
    line: 76-79
    status: "å®Ÿè£…æ¸ˆã¿ã ãŒæœªæ©Ÿèƒ½"
    code: |
      IconButton(
        icon: const Icon(Icons.history),
        onPressed: () => _showMealPlanHistory(context),
        tooltip: 'çŒ®ç«‹å±¥æ­´',
      )
  history_method:
    line: 1127-1134
    status: "ã‚¹ã‚¿ãƒ–å®Ÿè£…"
    code: |
      void _showMealPlanHistory(BuildContext context) {
        // TODO: çŒ®ç«‹å±¥æ­´ç”»é¢ã‚’å®Ÿè£…
        ScaffoldMessenger.of(context).showSnackBar(
          const SnackBar(
            content: Text('çŒ®ç«‹å±¥æ­´æ©Ÿèƒ½ã¯æº–å‚™ä¸­ã§ã™'),
          ),
        );
      }

### AIã‚µãƒ¼ãƒ“ã‚¹
ai_meal_planning_service:
  location: "lib/core/services/ai_meal_planning_service.dart"
  features:
    - suggestMealPlan: çŒ®ç«‹ææ¡ˆ
    - suggestAlternatives: ä»£æ›¿çŒ®ç«‹ææ¡ˆ
    - generateShoppingList: è²·ã„ç‰©ãƒªã‚¹ãƒˆç”Ÿæˆ

## ç¾åœ¨ã®å®Ÿè£…ãƒ¬ãƒ™ãƒ«

### å®Œå…¨å®Ÿè£…æ¸ˆã¿
- âœ… çŒ®ç«‹ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«
- âœ… çŒ®ç«‹ææ¡ˆæ©Ÿèƒ½
- âœ… çŒ®ç«‹ä¿å­˜æ©Ÿèƒ½
- âœ… çŒ®ç«‹çŠ¶æ…‹ç®¡ç†
- âœ… Firestoreé€£æº
- âœ… çŒ®ç«‹å±¥æ­´ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼
- âœ… çŒ®ç«‹å±¥æ­´å–å¾—API

### éƒ¨åˆ†å®Ÿè£…æ¸ˆã¿
- ğŸ”„ çŒ®ç«‹å±¥æ­´UIï¼ˆãƒœã‚¿ãƒ³ã¯å­˜åœ¨ã™ã‚‹ãŒæ©Ÿèƒ½ãªã—ï¼‰

### æœªå®Ÿè£…
- âŒ çŒ®ç«‹å±¥æ­´ç”»é¢UI
- âŒ å±¥æ­´è¡¨ç¤ºæ©Ÿèƒ½
- âŒ å±¥æ­´ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°æ©Ÿèƒ½
- âŒ å±¥æ­´æ¤œç´¢æ©Ÿèƒ½
- âŒ éå»ã®çŒ®ç«‹å†åˆ©ç”¨æ©Ÿèƒ½

## æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

### ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯
- Flutter (Dart)
- Riverpod (çŠ¶æ…‹ç®¡ç†)
- Cloud Firestore (ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹)

### ä¾å­˜é–¢ä¿‚
- flutter_riverpod: ^2.4.9
- cloud_firestore: ^4.13.6
- google_generative_ai: ^0.2.2
- uuid: ^4.2.1

## ãƒ•ã‚¡ã‚¤ãƒ«æ§‹é€ 

```
lib/
â”œâ”€â”€ core/
â”‚   â””â”€â”€ services/
â”‚       â”œâ”€â”€ firestore_service.dart âœ…
â”‚       â””â”€â”€ ai_meal_planning_service.dart âœ…
â”œâ”€â”€ features/
â”‚   â””â”€â”€ meal_planning/
â”‚       â””â”€â”€ presentation/
â”‚           â”œâ”€â”€ pages/
â”‚           â”‚   â””â”€â”€ meal_plan_screen.dart ğŸ”„
â”‚           â””â”€â”€ providers/
â”‚               â””â”€â”€ meal_plan_provider.dart âœ…
â””â”€â”€ shared/
    â””â”€â”€ models/
        â”œâ”€â”€ meal_plan.dart âœ…
        â””â”€â”€ shopping_item.dart âœ…
```

## å®Ÿè£…ã®å¼·ã¿

1. **åŒ…æ‹¬çš„ãªãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«**: çŒ®ç«‹ã«é–¢ã™ã‚‹è©³ç´°ãªæƒ…å ±ã‚’ç®¡ç†
2. **çŠ¶æ…‹ç®¡ç†**: Riverpodã«ã‚ˆã‚‹åŠ¹ç‡çš„ãªçŠ¶æ…‹ç®¡ç†
3. **Firebaseé€£æº**: Firestoreã«ã‚ˆã‚‹æ°¸ç¶šåŒ–
4. **AIçµ±åˆ**: Gemini APIã«ã‚ˆã‚‹çŒ®ç«‹ææ¡ˆ
5. **å±¥æ­´åŸºç›¤**: å±¥æ­´ç®¡ç†ã®åŸºç¤å®Ÿè£…æ¸ˆã¿

## å®Ÿè£…ã®èª²é¡Œ

1. **UIä¸è¶³**: å±¥æ­´è¡¨ç¤ºç”»é¢ãŒæœªå®Ÿè£…
2. **æ©Ÿèƒ½ä¸è¶³**: ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ãƒ»æ¤œç´¢æ©Ÿèƒ½ãªã—
3. **ãƒ¦ãƒ¼ã‚¶ãƒ“ãƒªãƒ†ã‚£**: éå»çŒ®ç«‹ã®å†åˆ©ç”¨æ©Ÿèƒ½ãªã—
4. **ãƒ‡ã‚¶ã‚¤ãƒ³çµ±ä¸€**: æ—¢å­˜UIã¨ã®ä¸€è²«æ€§ç¢ºä¿ãŒå¿…è¦

## å®Ÿè£…é›£æ˜“åº¦è©•ä¾¡

- **ãƒ‡ãƒ¼ã‚¿ãƒ¬ã‚¤ãƒ¤ãƒ¼**: â˜…â˜†â˜†â˜†â˜† (ã»ã¼å®Œæˆ)
- **ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯**: â˜…â˜…â˜†â˜†â˜† (åŸºæœ¬å®Ÿè£…æ¸ˆã¿)
- **UIå®Ÿè£…**: â˜…â˜…â˜…â˜†â˜† (æ–°è¦ç”»é¢ä½œæˆå¿…è¦)
- **çµ±åˆãƒ†ã‚¹ãƒˆ**: â˜…â˜…â˜†â˜†â˜† (æ—¢å­˜æ©Ÿèƒ½ã¨ã®é€£æº)

## æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

1. çŒ®ç«‹å±¥æ­´ç”»é¢UIè¨­è¨ˆ
2. ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ãƒ»æ¤œç´¢æ©Ÿèƒ½è¨­è¨ˆ
3. éå»çŒ®ç«‹å†åˆ©ç”¨æ©Ÿèƒ½è¨­è¨ˆ
4. å®Ÿè£…è¨ˆç”»ç­–å®š
