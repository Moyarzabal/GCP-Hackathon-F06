product_image_generation_service:
  overview: "å•†å“è¿½åŠ å°‚ç”¨ã®ç”»åƒç”Ÿæˆã‚µãƒ¼ãƒ“ã‚¹ï¼ˆGemini 2.5 Flash Image Previewä½¿ç”¨ï¼‰"
  
  service_file: "lib/core/services/product_image_generation_service.dart"
  
  features:
    multi_stage_generation:
      method: "generateMultiStageProductIcons"
      description: "5ã¤ã®æ„Ÿæƒ…çŠ¶æ…‹ã®ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ç”»åƒã‚’ä¸€æ‹¬ç”Ÿæˆ"
      stages:
        - "veryFresh: ã¨ã¦ã‚‚æ–°é®®ï¼ˆ7æ—¥ä»¥ä¸Šï¼‰"
        - "fresh: æ–°é®®ï¼ˆ3-7æ—¥ï¼‰"
        - "warning: æ³¨æ„ï¼ˆ1-3æ—¥ï¼‰"
        - "urgent: ç·Šæ€¥ï¼ˆ0-1æ—¥ï¼‰"
        - "expired: æœŸé™åˆ‡ã‚Œï¼ˆ0æ—¥æœªæº€ï¼‰"
    
    single_icon_generation:
      method: "generateProductIcon"
      description: "è³å‘³æœŸé™ã«åŸºã¥ãå˜ä¸€ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ç”»åƒç”Ÿæˆ"
      compatibility: "å¾Œæ–¹äº’æ›æ€§ã®ãŸã‚ä¿æŒ"
  
  gemini_integration:
    api: "Gemini 2.5 Flash Image Preview"
    endpoint: "https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-image-preview:streamGenerateContent"
    response_format: "ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°å¿œç­”ï¼ˆè¤‡æ•°JSONã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆï¼‰"
    image_format: "Base64ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã•ã‚ŒãŸPNGç”»åƒ"
    
    prompt_structure:
      character_design: "kawaii anime/manga style character"
      background: "TRANSPARENT BACKGROUND (PNG format)"
      size: "512x512 pixels, square format"
      personality: "friendly, approachable personality"
      setting: "designed to live in a refrigerator"
  
  emotion_prompts:
    veryFresh:
      style: "Bright, vibrant colors, sparkling effects, energetic pose"
      emotion: "Big, bright smile, sparkling eyes, bouncing pose"
      colors: "bright greens, yellows, blues"
    
    fresh:
      style: "Clean, bright colors, polished appearance, relaxed pose"
      emotion: "Warm, friendly smile, bright eyes, comfortable pose"
      colors: "light greens, whites, soft blues"
    
    warning:
      style: "Muted, pastel colors, cautious appearance, defensive pose"
      emotion: "Small, worried smile, alert eyes, cautious pose"
      colors: "soft yellows, oranges, light browns"
    
    urgent:
      style: "Darker, intense colors, stressed appearance, frantic pose"
      emotion: "Frown, wide anxious eyes, frantic pose"
      colors: "deep oranges, reds, dark yellows"
    
    expired:
      style: "Dark, muted colors, wilted appearance, slumped pose"
      emotion: "Downcast expression, tired eyes, exhausted pose"
      colors: "grays, browns, dark purples"
  
  integration_with_scanner:
    file: "lib/features/scanner/presentation/pages/scanner_screen.dart"
    method: "_generateImageAsync"
    changes:
      - "ImageGenerationServiceã‹ã‚‰ProductImageGenerationServiceã«å¤‰æ›´"
      - "generateMultiStageProductIconsãƒ¡ã‚½ãƒƒãƒ‰ã‚’å‘¼ã³å‡ºã—"
      - "å•†å“IDã¨refã‚’æ¸¡ã—ã¦å•†å“æ›´æ–°ã‚’å®Ÿè¡Œ"
  
  error_handling:
    api_errors:
      - "GEMINI_API_KEY not found: ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ç”»åƒã‚’ä½¿ç”¨"
      - "APIå‘¼ã³å‡ºã—å¤±æ•—: ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ç”»åƒã‚’ä½¿ç”¨"
      - "JSONè§£æã‚¨ãƒ©ãƒ¼: ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ç”»åƒã‚’ä½¿ç”¨"
    
    fallback_images:
      method: "_getCharacterFallbackImageUrl"
      default: "assets/images/default_character.png"
      note: "å®Ÿéš›ã®ã‚¢ã‚»ãƒƒãƒˆç”»åƒãŒå­˜åœ¨ã™ã‚‹å ´åˆã¯ãã®ãƒ‘ã‚¹ã‚’è¿”ã™"
    
    logging:
      - "ğŸ¨ è¤‡æ•°æ®µéšã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ç”»åƒç”Ÿæˆé–‹å§‹"
      - "ğŸ–¼ï¸ å„æ®µéšã®ç”»åƒç”Ÿæˆä¸­"
      - "âœ… å„æ®µéšã®ç”»åƒç”Ÿæˆå®Œäº†"
      - "ğŸ‰ è¤‡æ•°æ®µéšç”»åƒç”Ÿæˆå®Œäº†"
      - "âŒ ç”»åƒç”Ÿæˆã‚¨ãƒ©ãƒ¼"
  
  product_update_integration:
    multi_stage_update:
      method: "_updateProductWithMultiStageImages"
      description: "è¤‡æ•°æ®µéšç”»åƒã§å•†å“ã‚’æ›´æ–°"
      ref_support: "WidgetRefã‚’ä½¿ç”¨ã—ãŸçŠ¶æ…‹æ›´æ–°"
    
    single_image_update:
      method: "_updateProductWithImageRef"
      description: "å˜ä¸€ç”»åƒã§å•†å“ã‚’æ›´æ–°"
      ref_support: "WidgetRefã‚’ä½¿ç”¨ã—ãŸçŠ¶æ…‹æ›´æ–°"
    
    app_state_integration:
      provider: "appStateProvider"
      methods:
        - "updateProductImages: è¤‡æ•°ç”»åƒæ›´æ–°"
        - "updateProductImage: å˜ä¸€ç”»åƒæ›´æ–°"
  
  advantages_over_previous:
    separation_of_concerns:
      - "æ–™ç†ç”»åƒç”Ÿæˆã¨å•†å“ç”»åƒç”Ÿæˆã‚’åˆ†é›¢"
      - "å°‚ç”¨ã®ã‚µãƒ¼ãƒ“ã‚¹ã§ä¿å®ˆæ€§å‘ä¸Š"
      - "äº’æ›æ€§ã‚’ä¿ã¡ãªãŒã‚‰æ–°æ©Ÿèƒ½ã‚’è¿½åŠ "
    
    improved_prompts:
      - "Gemini 2.5 Flash Image Previewã«æœ€é©åŒ–"
      - "ã‚ˆã‚Šè©³ç´°ãªã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ãƒ‡ã‚¶ã‚¤ãƒ³æŒ‡ç¤º"
      - "èƒŒæ™¯é€éPNGã®ç”Ÿæˆ"
      - "å†·è”µåº«ç’°å¢ƒã«ç‰¹åŒ–ã—ãŸãƒ‡ã‚¶ã‚¤ãƒ³"
    
    better_error_handling:
      - "è©³ç´°ãªãƒ­ã‚°å‡ºåŠ›"
      - "æ®µéšåˆ¥ã®ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°"
      - "é©åˆ‡ãªãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯å‡¦ç†"
  
  testing_recommendations:
    unit_tests:
      - "å„æ®µéšã®ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆç”Ÿæˆãƒ†ã‚¹ãƒˆ"
      - "JSONè§£ææ©Ÿèƒ½ã®ãƒ†ã‚¹ãƒˆ"
      - "ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®ãƒ†ã‚¹ãƒˆ"
    
    integration_tests:
      - "Gemini APIã¨ã®çµ±åˆãƒ†ã‚¹ãƒˆ"
      - "å•†å“æ›´æ–°æ©Ÿèƒ½ã®ãƒ†ã‚¹ãƒˆ"
      - "è¤‡æ•°æ®µéšç”»åƒç”Ÿæˆã®ãƒ†ã‚¹ãƒˆ"
    
    manual_tests:
      - "å•†å“è¿½åŠ ã§ã®ç”»åƒç”Ÿæˆç¢ºèª"
      - "å„æ„Ÿæƒ…çŠ¶æ…‹ã®ç”»åƒç”Ÿæˆç¢ºèª"
      - "ã‚¨ãƒ©ãƒ¼æ™‚ã®é©åˆ‡ãªå‡¦ç†ç¢ºèª"
  
  monitoring:
    success_metrics:
      - "ç”»åƒç”ŸæˆæˆåŠŸç‡"
      - "å„æ®µéšã®ç”ŸæˆæˆåŠŸç‡"
      - "APIå‘¼ã³å‡ºã—æˆåŠŸç‡"
    
    error_metrics:
      - "APIã‚¨ãƒ©ãƒ¼ç™ºç”Ÿç‡"
      - "JSONè§£æã‚¨ãƒ©ãƒ¼ç™ºç”Ÿç‡"
      - "ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ä½¿ç”¨ç‡"
    
    performance_metrics:
      - "å¹³å‡ç”»åƒç”Ÿæˆæ™‚é–“"
      - "å„æ®µéšã®ç”Ÿæˆæ™‚é–“"
      - "APIå¿œç­”æ™‚é–“"

