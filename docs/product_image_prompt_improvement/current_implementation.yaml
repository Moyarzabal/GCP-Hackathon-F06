name: å•†å“ç”»åƒç”Ÿæˆãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ - ç¾åœ¨ã®å®Ÿè£…
description: å•†å“ç”»åƒç”Ÿæˆã«ãŠã‘ã‚‹ç¾åœ¨ã®ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆå®Ÿè£…ã®è©³ç´°åˆ†æ
version: "1.0"
date: "2025-09-20"

current_implementation:
  location: lib/core/services/imagen_service.dart
  method: _createPrompt
  
  base_prompt_structure:
    template: "Cute kawaii Japanese mascot character representing $productName ($category food item), "
    issues:
      - product_name_inclusion: "å•†å“åãŒç›´æ¥ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã«å«ã¾ã‚Œã€ç”»åƒå†…ã«æ–‡å­—ã¨ã—ã¦è¡¨ç¤ºã•ã‚Œã‚‹å¯èƒ½æ€§"
      - text_rendering_risk: "å•†å“åã‚„ã‚«ãƒ†ã‚´ãƒªãŒç”»åƒå†…ã«ãƒ†ã‚­ã‚¹ãƒˆã¨ã—ã¦æç”»ã•ã‚Œã‚‹å•é¡Œ"
  
  emotion_states:
    happy:
      emoji: "ğŸ˜Š"
      current_prompt: "happy and fresh, bright colors, smiling face, sparkles around, chibi style, simple design"
      expiry_context: "æ–°é®®ãªçŠ¶æ…‹"
      
    neutral:
      emoji: "ğŸ˜"
      current_prompt: "neutral expression, slightly concerned, pastel colors, chibi style, simple design"
      expiry_context: "ã‚„ã‚„å¿ƒé…ãªçŠ¶æ…‹"
      
    worried:
      emoji: "ğŸ˜Ÿ"
      current_prompt: "worried expression, sweat drops, muted colors, looking anxious, chibi style, simple design"
      expiry_context: "å¿ƒé…ãªçŠ¶æ…‹"
      
    panicking:
      emoji: "ğŸ˜°"
      current_prompt: "very worried and panicking, dark shadows, urgent expression, chibi style, simple design"
      expiry_context: "ãƒ‘ãƒ‹ãƒƒã‚¯çŠ¶æ…‹"
      
    expired:
      emoji: "ğŸ’€"
      current_prompt: "zombie-like appearance, expired and spooky, dark colors, ghost-like, chibi style, simple design"
      expiry_context: "æœŸé™åˆ‡ã‚ŒçŠ¶æ…‹"

  identified_problems:
    text_appearance:
      issue: "å•†å“åãŒãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã«ç›´æ¥å«ã¾ã‚Œã‚‹ã“ã¨ã§ç”»åƒå†…ã«æ–‡å­—ã¨ã—ã¦è¡¨ç¤ºã•ã‚Œã‚‹"
      impact: "ç”»åƒã®è¦‹ãŸç›®ãŒæãªã‚ã‚Œã€ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã®é­…åŠ›ãŒä½ä¸‹"
      examples:
        - "ã‚Šã‚“ã”"
        - "ç‰›ä¹³"
        - "ãƒ‘ãƒ³"
      
    insufficient_haze_expression:
      issue: "è³å‘³æœŸé™ã®çŸ­ç¸®ã«ä¼´ã†ã‚‚ã‚„ã®è¡¨ç¾ãŒä¸ååˆ†"
      current_state: "dark shadows ã®ã¿ã§ã€æ¿ƒã„ã‚‚ã‚„ã®æ®µéšçš„è¡¨ç¾ãŒãªã„"
      missing_elements:
        - "è»½ã„ã‚‚ã‚„ (ğŸ˜)"
        - "ä¸­ç¨‹åº¦ã®ã‚‚ã‚„ (ğŸ˜Ÿ)"
        - "æ¿ƒã„ã‚‚ã‚„ (ğŸ˜°)"
        - "éå¸¸ã«æ¿ƒã„ã‚‚ã‚„ (ğŸ’€)"

  technical_context:
    api: "Vertex AI Imagen API"
    model: "imagen-3.0-generate-001"
    parameters:
      aspect_ratio: "1:1"
      sample_count: 1
      add_watermark: false
      safety_filter_level: "block_none"
      person_generation: "dont_allow"

  fallback_mechanism:
    when_api_fails: "ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ç”»åƒã‚’ä½¿ç”¨"
    fallback_images:
      - "assets/images/happy_food.png"
      - "assets/images/neutral_food.png"
      - "assets/images/worried_food.png"
      - "assets/images/panicking_food.png"
      - "assets/images/expired_food.png"

  cache_system:
    implementation: "ãƒ¡ãƒ¢ãƒªãƒ™ãƒ¼ã‚¹ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥"
    cache_key: "${productName}_$emotionState"
    methods:
      - getCachedOrGenerateImage
      - clearCache

strengths:
  - emotion_based_generation: "æ„Ÿæƒ…çŠ¶æ…‹ã«åŸºã¥ãé©åˆ‡ãªç”»åƒç”Ÿæˆ"
  - kawaii_aesthetic: "ã‹ã‚ã„ã„æ—¥æœ¬ã®ãƒã‚¹ã‚³ãƒƒãƒˆã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼é¢¨"
  - fallback_system: "APIå¤±æ•—æ™‚ã®é©åˆ‡ãªãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯"
  - caching: "åŠ¹ç‡çš„ãªã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚·ã‚¹ãƒ†ãƒ "

weaknesses:
  - text_rendering: "å•†å“åã®æ–‡å­—è¡¨ç¤ºå•é¡Œ"
  - limited_haze_progression: "ã‚‚ã‚„ã®æ®µéšçš„è¡¨ç¾ã®ä¸è¶³"
  - generic_character: "å•†å“å›ºæœ‰ã®ç‰¹å¾´è¡¨ç¾ã®ä¸è¶³"
  - static_prompts: "å›ºå®šçš„ãªãƒ—ãƒ­ãƒ³ãƒ—ãƒˆæ§‹é€ "
